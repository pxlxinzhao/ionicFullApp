<ion-view class="chat-view">
    <ion-content>
        <ion-refresher
                pulling-text="Load more..."
                on-refresh="loadMore()"
                spinner="ios">
        </ion-refresher>

        <div ng-repeat="message in messages" ng-class="{'chat-entry': 1, 'chat-right': isRight(message)}">
            <img ng-src="{{photoUrlCache[message.senderId]}}" ng-class="{'wechat-user-icon': 1, 'chat-right': isRight(message)}"/>
            <div class="chat-chatbox-container">
                <p ng-if="!isImage(message.message)" class="chat-chatbox">{{message.message}}</p>
                <img ng-if="isImage(message.message)" class="chat-image" style="max-width: 100%" data-ng-src="{{message.message}}">
            </div>
        </div>

        <div class="empty-div"></div>
        <div class="empty-div"></div>
    </ion-content>

    <div class="bar bar-footer bar-assertive chat-bar">
        <div class="list chat-list">

            <div class="item item-input-inset">

                <label class="item-input-wrapper">
                    <input class="chat-message" type="text" placeholder="Message" ng-model="message" on-enter="sendMessage()">
                </label>

                <ion-icon ng-click="openPopover()"
                        class="ion-android-add-circle" style="font-size: 24px;  margin-left: 6px;"></ion-icon>

                <button class="button button-small" ng-click="sendMessage()">
                    Send
                </button>
            </div>
        </div>
    </div>
</ion-view>